========================================
ITEM UPGRADE - STAT SCALING DETAILS
Date: November 8, 2025
========================================

WHAT STATS ARE SCALED:
=======================

✅ **Primary Stats (ALL scaled by multiplier)**
   - Strength
   - Agility
   - Stamina
   - Intellect
   - Spirit

✅ **Secondary Stats (ALL scaled by multiplier)**
   - Hit Rating
   - Critical Strike Rating
   - Haste Rating
   - Expertise Rating
   - Dodge Rating
   - Parry Rating
   - Defense Rating
   - Block Rating
   - Resilience Rating
   - Armor Penetration Rating

✅ **Armor & Resistances**
   - Base Armor
   - Fire Resistance
   - Nature Resistance
   - Frost Resistance
   - Shadow Resistance
   - Arcane Resistance

✅ **Weapon Stats**
   - Weapon Damage (Min and Max)
   - Weapon Speed (unchanged - only damage scales)
   - DPS increases proportionally

✅ **Bonus Stats**
   - Spell Power Bonus
   - Attack Power Bonus
   - Ranged Attack Power Bonus

SCALING FORMULA:
================

Stat Multiplier = 1.0 + (upgrade_level × 0.025)

Examples:
- Level 0:  1.00x (base, no bonus)
- Level 5:  1.125x (+12.5% all stats)
- Level 10: 1.25x (+25% all stats)
- Level 15: 1.375x (+37.5% all stats)

TOOLTIP ENHANCEMENTS:
=====================

**Item Tooltips** (when hovering over items):
```
Upgrade Level 10 / 15
Item Level: 245 (Base 245)
All Stats: +25.0%
This includes:
  • Primary Stats (Str/Agi/Sta/Int/Spi) x1.25
  • Secondary Stats (Crit/Haste/Hit) x1.25
  • Armor and Resistances x1.25
  • Weapon Damage x1.25
  • Spell Power x1.25
```

**Upgrade UI Preview** (when selecting upgrade level):
```
After Upgrade:
Upgrade Level: 15/15 (+5)
Item Level: 260 (+15)

All Stats: +10.0% (from x1.25 to x1.38)
Includes:
  • Primary Stats (Str/Agi/Sta/Int/Spi)
  • Secondary Stats (Crit/Haste/Hit)
  • Armor and Resistances
  • Weapon Damage (if applicable)
  • Spell Power (if applicable)
```

EXAMPLE CALCULATIONS:
=====================

**Example 1: Weapon**
Base Weapon: 100-150 damage, 2.0 speed
- Base DPS: 62.5
- At +5 upgrades (1.125x): 112-169 damage = 70.3 DPS (+12.5%)
- At +10 upgrades (1.25x): 125-188 damage = 78.1 DPS (+25%)
- At +15 upgrades (1.375x): 137-206 damage = 85.9 DPS (+37.5%)

**Example 2: Armor Piece**
Base Stats: +50 Strength, +80 Stamina, 500 Armor
- At +5 upgrades: +56 Str, +90 Sta, 562 Armor
- At +10 upgrades: +62 Str, +100 Sta, 625 Armor  
- At +15 upgrades: +69 Str, +110 Sta, 687 Armor

**Example 3: Caster Item**
Base Stats: +60 Intellect, +80 Spirit, +100 Spell Power
- At +5 upgrades: +67 Int, +90 Spi, +112 SP
- At +10 upgrades: +75 Int, +100 Spi, +125 SP
- At +15 upgrades: +82 Int, +110 Spi, +137 SP

**Example 4: Secondary Stats**
Base Stats: +40 Hit Rating, +60 Crit Rating, +50 Haste Rating
- At +5 upgrades: +45 Hit, +67 Crit, +56 Haste
- At +10 upgrades: +50 Hit, +75 Crit, +62 Haste
- At +15 upgrades: +55 Hit, +82 Crit, +69 Haste

HOW TO VERIFY SCALING:
======================

1. **Check Base Stats**
   - Hover over unupgraded item
   - Note all stat values

2. **Upgrade the Item**
   - Upgrade to any level
   - Character stats should increase IMMEDIATELY

3. **Check Character Sheet**
   - Press 'C' to open character panel
   - All stats from that item should be higher
   - Multiply base values by multiplier to verify

4. **Check Weapon Damage**
   - Main hand weapon upgraded
   - Character sheet shows increased damage range
   - Attack Power calculations use new damage

5. **Check Spell Power**
   - Caster item with spell power upgraded
   - Character sheet shows increased spell damage
   - Healing also increases proportionally

TECHNICAL IMPLEMENTATION:
==========================

Server-Side (C++):
- ItemUpgradeStatApplication.cpp handles stat application
- ApplyMultiplierToItemStats() scales ItemTemplate values
- Modifies: ItemStat array, Armor, Damage array, SpellPowerBonus
- Called on: Item equip, player login, after upgrade

Client-Side (Lua):
- DarkChaos_ItemUpgrade_Retail.lua shows upgrade info
- Enhanced tooltips display multiplier breakdown
- Preview window shows before/after comparison
- Real-time calculation of stat increases

FILES MODIFIED:
===============

1. ItemUpgradeStatApplication.cpp
   - Added scaling for SpellPowerBonus
   - Added scaling for AttackPowerBonus
   - Added scaling for RangedAttackPowerBonus
   - Enhanced comments explaining what's scaled

2. DarkChaos_ItemUpgrade_Retail.lua
   - Enhanced DarkChaos_ItemUpgrade_AttachTooltipLines()
   - Shows detailed breakdown of what multiplier affects
   - Enhanced DarkChaos_ItemUpgrade_GenerateTooltips()
   - Preview shows before/after multiplier comparison
   - Lists all stat categories affected

TESTING CHECKLIST:
==================

Equip upgraded item and verify these increase:
[ ] Strength/Agility/Stamina/Intellect/Spirit
[ ] Hit/Crit/Haste rating percentages
[ ] Armor value
[ ] Weapon damage (main hand and off-hand)
[ ] Attack Power
[ ] Spell Power (if caster item)
[ ] Spell Damage in character sheet
[ ] Healing Power in character sheet
[ ] All resistance values

Unequip and re-equip:
[ ] Stats should decrease when unequipped
[ ] Stats should increase when re-equipped
[ ] Values should match multiplier calculation

Log out and back in:
[ ] All upgraded stats persist
[ ] Character sheet shows correct values
[ ] No stat loss or duplication

KNOWN LIMITATIONS:
==================

1. **Enchants**: Enchantments are NOT scaled
   - Only base item stats are multiplied
   - +15 Strength enchant stays +15
   
2. **Gems**: Socket bonuses are NOT scaled
   - Gems retain their base values
   - +10 Strength gem stays +10

3. **Set Bonuses**: Set bonuses are NOT scaled
   - 2pc/4pc bonuses unchanged
   - Only individual item stats scale

4. **Proc Effects**: Proc damage/healing NOT scaled
   - "Chance on hit" effects unchanged
   - Trinket procs unchanged

These limitations are intentional to keep the system balanced!
